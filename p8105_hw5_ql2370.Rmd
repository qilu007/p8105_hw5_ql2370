---
title: "HW 5"
author: "QiLu"
date: "11/9/2019"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
### Problem 1

```{r}
library(tidyverse)
library(readr)
library(dplyr)

set.seed(10)

iris_with_missing = iris %>% 
  map_df(~replace(.x, sample(1:150, 20), NA)) %>%
  mutate(Species = as.character(Species))

```

output = vector("list", length = 4)


```{r}
fill_in = function(x) {

  if (is.numeric(x)){
    x_changed = x %>% replace_na(mean(x, na.rm=TRUE))
}
  else if(is.character(x)){
  x_changed = replace_na(x,"virginica")
 
  }
  
  tibble(x_changed)
}
```




```{r}
output = vector("list", length = 5)
output = bind_cols(map(iris_with_missing, fill_in))
output

```

### Problem 2


```{r, message=FALSE}
data_import = list.files(pattern="*.csv", recursive = TRUE) %>% 
  purrr::map(~read_csv(.)) %>% 
  bind_rows(.id = "id")
data_import$con_exp = "exp"
data_import$id = as.numeric(data_import$id)


data_import$con_exp = replace(data_import$con_exp, data_import$id < 11, "con")

data_import_plot = pivot_longer(data_import,week_1:week_8,names_to = "week", values_to = "number") %>% 
  group_by(id,week)

```

```{r}
data_import_plot %>% 
ggplot(aes(x = week, y = number, group = id, color = id)) +
  geom_point() + geom_line(aes(color = id))
```

The difference between control arm and experimental increase by weeks.




